#the main aim of this code is to provide an analysis of the landslide happened in Blatten (CH) in 28th of May 2025
#After a brief visual analysis of the spatial changement produced by the landslide, we will proceed to a more specific analysises such as the condition of the River "Lonza" and a classification of the debris produced

#importing the libraries 
library(terra)
library(imageRy)

#Importing datasets of images in order to perform the analysis
#setting a working directory to the main folder of the images 
setwd("C:/Users/andre/Desktop/Blatten")

#importing 4 images downloaded by the browser of the european satellite Sentinel-2 (True Color)
#first image: Blatten area 18.05.2025
Bl1 <-rast("18-05-2025_Sentinel-2_L1C_True_color.tiff")
plotRGB(Bl1, r=1, g=2, b=3, stretch="lin")
#second image: Blatten area 30.05.2025
Bl2 <-rast("30-05-2025_Sentinel-2_L1C_True_color.tiff")
plotRGB(Bl2, r=1, g=2, b=3, stretch="lin")
#third image: Blatten area 20.09.2025
Bl3 <-rast("20-09-2025_Sentinel-2_L1C_True_color.tiff")
plotRGB(Bl3, r=1, g=2, b=3, stretch="lin")
#fourth image: Blatten area 20.01.2026
Bl4 <-rast("20-01-2026_Sentinel-2_L1C_True_color.tiff")
plotRGB(Bl4, r=1, g=2, b=3, stretch="lin")

#importing 4 images downloaded by the browser of the european satellite Sentinel-2 (False Color)
#first image: Blatten area 18.05.2025
Bl1FC <-rast("2025-05-18_Sentinel-2_L1C_False_color.tiff")
plot(Bl1FC)
#second image: Blatten area 30.05.2025
Bl2FC <-rast("2025-05-30_Sentinel-2_L1C_False_color.tiff")
plot(Bl2FC)
#third image: Blatten area 20.09.2025
Bl3FC <-rast("2025-09-20_Sentinel-2_L1C_False_color.tiff")
plot(Bl3FC)
#fourth image: Blatten area 20.01.2026
Bl4FC <-rast("2026-01-20_Sentinel-2_L1C_False_color.tiff")
plot(Bl4FC)

#The images in NDVI and NDWI are just 3 for a specific reason: in winter the amount of snow fallen made useless this combination of bands for the image of the 20th of January
#importing 3 images downloaded by the browser of the european satellite Sentinel-2 (NDVI)
#first image: Blatten area 18.05.2025
Bl1NDVI <-rast("2025-05-18_Sentinel-2_L1C_NDVI.tiff")
plot(Bl1NDVI)
#second image: Blatten area 30.05.2025
Bl2NDVI <-rast("2025-05-30_Sentinel-2_L1C_NDVI.tiff")
plot(Bl2NDVI)
#third image: Blatten area 20.09.2025
Bl3NDVI <-rast("2025-09-20_Sentinel-2_L1C_NDVI.tiff")
plot(Bl3NDVI)

#importing 3 images downloaded by the browser of the european satellite Sentinel-2 (NDWI)
#first image: Blatten area 18.05.2025
Bl1NDWI <-rast("2025-05-18_Sentinel-2_L1C_NDWI.tiff")
plot(Bl1NDWI)
#second image: Blatten area 30.05.2025
Bl2NDWI <-rast("2025-05-30_Sentinel-2_L1C_NDWI.tiff")
plot(Bl2NDWI)
#third image: Blatten area 20.09.2025
Bl3NDWI <-rast("2025-09-20_Sentinel-2_L1C_NDWI.tiff")
plot(Bl3NDWI)

#The choice of True Color, False Color, NDVI and NDWI is made in order to provide the best visualization of the landslide the surface water and the debris
#showing the image of before and after the landslide in true color
par(mfrow=c(2,2))
plotRGB(Bl1, r=1, g=2, b=3, stretch="lin")
plotRGB(Bl2, r=1, g=2, b=3, stretch="lin")
plotRGB(Bl3, r=1, g=2, b=3, stretch="lin")
plotRGB(Bl4, r=1, g=2, b=3, stretch="lin")
dev.off()

#showing the image of before and after the landslide in false color
par(mfrow=c(2,2))
plot(Bl1FC)
plot(Bl2FC)
plot(Bl3FC)
plot(Bl4FC)
dev.off()

#showing the image of before and after the landslide in NDVI (debris)
par(mfrow=c(3,1))
plot(Bl1NDVI)
plot(Bl2NDVI)
plot(Bl3NDVI)
dev.off()

#showing the image of before and after the landslide in NDWI (surface water)
par(mfrow=c(3,1))
plot(Bl1NDWI)
plot(Bl2NDWI)
plot(Bl3NDWI)
dev.off()

#using the library imageRy it has been done an unsupervised classification in order to acquire possible new data on the first 3 images in true colors
#the resulting clusters represent spectrally homogeneous groups of pixels and were used to evaluate changes in surface composition induced by the landslide.
class1 <- im.classify(Bl1, num_clusters=4) #Image True color 18.05.25
class2 <- im.classify(Bl2, num_clusters=4) #Image True color 30.05.25
class3 <- im.classify(Bl3, num_clusters=4) #Image True color 20.09.25

#plotting classifications in order to better visualize them 
par(mfrow=c(2,2))
plot(class1, main="18.05.25")
plot(class2, main="30.05.25")
plot(class3, main="20.09.25")
dev.off()
